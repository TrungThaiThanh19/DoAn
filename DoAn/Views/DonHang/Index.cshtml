@model List<DoAn.Models.HoaDon>
@{
    ViewData["Title"] = "Đơn hàng của tôi";

    string StepText(int s) => s switch
    {
        0 => "⏳ Chờ xác nhận",
        1 => "✅ Đã xác nhận",
        2 => "🚚 Đang vận chuyển",
        3 => "💳 Chờ thanh toán",
        4 => "🎉 Hoàn thành",
        5 => "❌ Đã hủy",
        7 => "↩️ Hoàn hàng thành công",
        _ => "❔ Không rõ"
    };

    string StepBadgeClass(int s) => s switch
    {
        0 => "badge bg-warning text-dark",
        1 => "badge bg-primary",
        2 => "badge bg-info text-dark",
        3 => "badge bg-secondary",
        4 => "badge bg-success",
        5 => "badge bg-danger",
        7 => "badge bg-success",
        _ => "badge bg-dark"
    };
}
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

<h2 class="mb-4 text-primary fw-bold">
    <i class="fa fa-receipt me-2"></i>Đơn hàng của tôi
</h2>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success shadow-sm">
        <i class="fa fa-check-circle me-1"></i>@TempData["Success"]
    </div>
}
@if (TempData["Error"] != null)
{
    <div class="alert alert-danger shadow-sm">
        <i class="fa fa-triangle-exclamation me-1"></i>@TempData["Error"]
    </div>
}

@if (Model == null || !Model.Any())
{
    <div class="alert alert-info text-center p-4 shadow-sm rounded">
        <i class="fa fa-box-open fa-2x mb-2"></i><br />
        Bạn chưa có đơn hàng nào.
    </div>
}
else
{
    <div class="card shadow-lg border-0 rounded-4 mb-3">
        <div class="card-body p-0">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th class="text-center">Mã đơn</th>
                        <th>Ngày tạo</th>
                        <th>Loại</th>
                        <th>Trạng thái</th>
                        <th class="text-end">Tổng tiền</th>
                        <th class="text-center">Hành động</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var o in Model)
                    {
                        <tr>
                            <td class="text-center fw-bold text-primary">@o.Ma_HoaDon</td>
                            <td>@o.NgayTao.ToString("dd/MM/yyyy HH:mm")</td>
                            <td>@(string.IsNullOrWhiteSpace(o.LoaiHoaDon) ? "Offline" : o.LoaiHoaDon)</td>
                            <td>
                                <span class="@StepBadgeClass(o.TrangThai)">
                                    @StepText(o.TrangThai)
                                </span>
                            </td>
                            <td class="text-end fw-bold text-danger">@o.TongTienSauGiam.ToString("n0") đ</td>
                            <td class="text-center">
                                <a class="btn btn-sm btn-outline-primary rounded-pill px-3 shadow-sm"
                                   asp-action="Track" asp-route-id="@o.ID_HoaDon" title="Theo dõi đơn">
                                    <i class="fa fa-location-dot"></i> Theo dõi
                                </a>

                                @if (o.TrangThai <= 1)
                                {
                                    <form asp-action="Huy" method="post" class="d-inline"
                                          onsubmit="return confirm('Hủy đơn @o.Ma_HoaDon ?');">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="id" value="@o.ID_HoaDon" />
                                        <button class="btn btn-sm btn-outline-danger rounded-pill px-3 ms-1">
                                            <i class="fa fa-ban"></i> Hủy
                                        </button>
                                    </form>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
}

<div class="text-center mt-4">
    <a class="btn btn-lg btn-success rounded-pill px-4 shadow"
       asp-controller="Shop" asp-action="Index">
        <i class="fa fa-arrow-left me-2"></i> Quay lại cửa hàng
    </a>
</div>
